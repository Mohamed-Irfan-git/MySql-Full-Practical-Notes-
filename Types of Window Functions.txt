ðŸ”¹ Types of Window Functions
1. Aggregate Window Functions

Aggregate functions used with OVER() instead of GROUP BY.

SUM()

AVG()

MIN()

MAX()

COUNT()

Example:

SELECT 
    department,
    name,
    salary,
    SUM(salary) OVER (PARTITION BY department) AS total_dept_salary
FROM Employees;


ðŸ‘‰ Shows each employeeâ€™s salary + total salary of their department.

2. Ranking Functions

Used to assign ranks/numbers to rows.

ROW_NUMBER() â†’ Unique sequence number per row.

RANK() â†’ Gives same rank for ties, skips next rank.

DENSE_RANK() â†’ Same rank for ties, but no gaps.

NTILE(n) â†’ Splits rows into n groups.

Example:

SELECT 
    name,
    salary,
    ROW_NUMBER() OVER (ORDER BY salary DESC) AS row_num,
    RANK() OVER (ORDER BY salary DESC) AS rank,
    DENSE_RANK() OVER (ORDER BY salary DESC) AS dense_rank,
    NTILE(3) OVER (ORDER BY salary DESC) AS bucket
FROM Employees;

3. Value Window Functions

Return specific row values relative to the current row.

LEAD() â†’ Get value from the next row.

LAG() â†’ Get value from the previous row.

FIRST_VALUE() â†’ First value in the window.

LAST_VALUE() â†’ Last value in the window.

Example:

SELECT 
    name,
    salary,
    LAG(salary) OVER (ORDER BY salary) AS prev_salary,
    LEAD(salary) OVER (ORDER BY salary) AS next_salary
FROM Employees;


ðŸ‘‰ Compare each employeeâ€™s salary with the one before and after.

4. Analytic Functions

Some databases include:

PERCENT_RANK() â†’ Relative rank (0â€“1).

CUME_DIST() â†’ Cumulative distribution.

NTH_VALUE() â†’ Nth value in the window.

Example:

SELECT 
    name,
    salary,
    PERCENT_RANK() OVER (ORDER BY salary) AS percent_rank,
    CUME_DIST() OVER (ORDER BY salary) AS cumulative_distribution
FROM Employees;

ðŸ”¹ Window Function Structure

General syntax:

function_name(column) 
OVER (
    PARTITION BY column(s)   -- divide data into groups
    ORDER BY column(s)       -- define row order
    ROWS BETWEEN ...         -- (optional) window frame
)

âœ… Summary of Window Function Types

Aggregate â†’ SUM, AVG, COUNT (over partitions)

Ranking â†’ ROW_NUMBER, RANK, DENSE_RANK, NTILE

Value â†’ LEAD, LAG, FIRST_VALUE, LAST_VALUE

Analytic/Distribution â†’ PERCENT_RANK, CUME_DIST, NTH_VALUE
